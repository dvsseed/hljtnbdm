{"version":3,"sources":["soap.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"soap.js","sourcesContent":["$( document ).ready(function() {\n    //set up main class\n    $(\"#main_class\").find(\"button\").click(function(event){\n        event.preventDefault();\n        $(\"#main_class\").find(\".btn-primary\").removeClass('btn-primary');\n        $(this).addClass('btn-primary');\n        $(this).blur();\n        $.ajax({\n            type: 'GET',\n            url: '/soap/get_sub/' + $(this).attr('data'),\n            success: function(result){\n                if(result){\n                    var html = \"\";\n                    for(var i = 0; i< result.length; i++){\n                        html += '<option value=\"' + result[i].sub_class_pk + '\">' + result[i].class_name + '</option>';\n                    }\n\n                    $(\"#sub_class\").html(html);\n                    if(result.length > 0){\n                        setSOAClass(result[0].sub_class_pk);\n                    }\n                }\n            }\n        });\n    });\n\n    $(\"#sub_class\").change(function(){\n        setSOAClass( $(this).val());\n    });\n\n    $(\"#s\").click(function(){\n        appendText( $(this).find('option:selected').text(), $(\"#s_text\"));\n    });\n\n    $(\"#o\").click(function(){\n        appendText( $(this).find('option:selected').text(), $(\"#o_text\"));\n    });\n\n    $(\"#a\").click(function(){\n        setSOADetail( $(this).val() );\n        appendText( $(this).find('option:selected').text(), $(\"#a_text\"));\n    });\n\n    $(\"#p\").click(function(){\n        appendText( $(this).find('option:selected').text(), $(\"#p_text\"));\n    });\n\n    $(\"#e\").click(function(){\n        appendText( $(this).find('option:selected').text(), $(\"#e_text\"));\n    });\n\n    $(\"#customize_type\").change(function(){\n        setCustomize($(\"#customize_type\").val());\n        $(\"#customize_text\").val(\"\");\n    });\n\n    $(\"#customize_select\").click(function(){\n        var select_id = \"#\" + $(\"#customize_type\").val().toLowerCase() + \"_text\";\n        appendText( $(this).find('option:selected').text(), $(select_id));\n    });\n\n    $(\"#customize_btn\").click(function(e){\n        e.preventDefault();\n        var inputdata = {};\n        inputdata['types'] = $(\"#customize_type\").val();\n        inputdata['text'] = $(\"#customize_text\").val();\n        inputdata['_token'] = $('#customize > input[ name=_token]').val();\n        $.ajax({\n            type: 'POST',\n            url: '/soap/get_customize',\n            data: inputdata,\n            success: function(result){\n                if(result == 'success'){\n                    setCustomize($(\"#customize_type\").val());\n                    $(\"#customize_text\").val(\"\");\n                    $(\"#customize_btn\").blur();\n                }\n            }\n        });\n    });\n\n    $(\"#soap_save_btn\").click(function(e){\n        e.preventDefault();\n        var inputdata = {};\n        inputdata['s_text'] = $(\"#s_text\").val();\n        inputdata['o_text'] = $(\"#o_text\").val();\n        inputdata['a_text'] = $(\"#a_text\").val();\n        inputdata['p_text'] = $(\"#p_text\").val();\n        inputdata['e_text'] = $(\"#e_text\").val();\n        inputdata['r_text'] = $(\"#r_text\").val();\n        inputdata['_token'] = $('#customize > input[ name=_token]').val();\n\n        if($(\"#history_pk\").val() != \"\"){\n            inputdata['history'] = $(\"#history_pk\").val();\n        }\n        $.ajax({\n            type: 'POST',\n            url: '/soap/post_soap',\n            data: inputdata,\n            success: function(result){\n                if(result == 'success'){\n                    alert(\"储存成功\");\n                    $(\"#soap_save_btn\").blur();\n                }else{\n                    alert(\"储存失败\");\n                    $(\"#soap_save_btn\").blur();\n                }\n            }\n        });\n    });\n\n    setCustomize($(\"#customize_type\").val());\n});\n\nfunction delete_soap(soap_history_pk){\n\n    if (confirm(\"确定要删除吗?\") == true) {\n        var inputdata = {};\n        inputdata['_token'] = $('#soap_save > input[ name=_token]').val();\n        inputdata['history'] = soap_history_pk;\n        $.ajax({\n            type: 'POST',\n            url: '/soap/delete_history/',\n            data: inputdata,\n            success: function(result){\n                if(result == \"success\"){\n                    location.reload();\n                }\n            }\n        });\n    }\n}\n\nfunction setSOAClass( sub_class_pk){\n    $.ajax({\n        type: 'GET',\n        url: '/soap/get_soa/' + sub_class_pk,\n        success: function(result){\n            if(result){\n                var html = \"\";\n                var soaps = [\"S\", \"O\", \"A\", \"E\"];\n                for(var j = 0; j < soaps.length; j++){\n                    var soap = soaps[j];\n                    for(var i = 0; i< result[soap].length; i++){\n                        html += '<option value=\"' + result[soap][i].soa_class_pk + '\">' + result[soap][i].class_name + '</option>';\n                    }\n                    $(\"#\"+soap.toLowerCase()).html(html);\n\n                    html = \"\";\n                }\n            }\n        }\n    });\n}\n\nfunction setSOADetail(soa_class_pk){\n    $.ajax({\n        type: 'GET',\n        url: '/soap/get_soa_detail/' + soa_class_pk,\n        success: function(result){\n            if(result){\n                var html = \"\";\n                for(var i = 0; i< result.length; i++){\n                    html += '<option value=\"' + result[i].soa_detail_pk + '\">' + result[i].detail_name + '</option>';\n                }\n                $(\"#p\").html(html);\n            }\n        }\n    });\n}\n\nfunction setCustomize( type){\n    $.ajax({\n        type: 'GET',\n        url: '/soap/get_customize/' + type,\n        success: function(result){\n            if(result){\n                var html = \"\";\n                for(var i = 0; i< result.length; i++){\n                    html += '<option value=\"' + result[i].user_customize_pk + '\">' + result[i].text + '</option>';\n                }\n                $(\"#customize_select\").html(html);\n            }\n        }\n    });\n}\n\nfunction appendText( text, textarea){\n    var old = textarea.val();\n    textarea.val( old + get_number(old)+ \". \" + text + \"\\n\");\n    textarea.scrollTop(textarea[0].scrollHeight);\n}\n\nfunction get_number(text){\n    if(text){\n        lines = text.split(\"\\n\");\n        for(var i = lines.length-1; i >= 0; i--){\n            heads = lines[i].split(\".\");\n            if(!isNaN(heads[0]) && heads[0] != \"\"){\n                return parseInt(heads[0])+1;\n            }\n        }\n    }\n\n    return 1;\n}"],"sourceRoot":"/source/"}