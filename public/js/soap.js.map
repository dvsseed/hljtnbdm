{"version":3,"sources":["soap.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"soap.js","sourcesContent":["$( document ).ready(function() {\r\n    //set up main class\r\n    $(\"#main_class\").find(\"button\").click(function(event){\r\n        event.preventDefault();\r\n        $(\"#main_class\").find(\".btn-primary\").removeClass('btn-primary');\r\n        $(this).addClass('btn-primary');\r\n        $(this).blur();\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: '/soap/get_sub/' + $(this).attr('data'),\r\n            success: function(result){\r\n                if(result){\r\n                    var html = \"\";\r\n                    for(var i = 0; i< result.length; i++){\r\n                        html += '<option value=\"' + result[i].sub_class_pk + '\">' + result[i].class_name + '</option>';\r\n                    }\r\n\r\n                    $(\"#sub_class\").html(html);\r\n                    if(result.length > 0){\r\n                        setSOAClass(result[0].sub_class_pk);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    $(\"#sub_class\").change(function(){\r\n        setSOAClass( $(this).val());\r\n    });\r\n\r\n    $(\"#s\").click(function(){\r\n        appendText( $(this).find('option:selected').text(), $(\"#s_text\"));\r\n    });\r\n\r\n    $(\"#o\").click(function(){\r\n        appendText( $(this).find('option:selected').text(), $(\"#o_text\"));\r\n    });\r\n\r\n    $(\"#a\").click(function(){\r\n        setSOADetail( $(this).val() );\r\n        appendText( $(this).find('option:selected').text(), $(\"#a_text\"));\r\n    });\r\n\r\n    $(\"#p\").click(function(){\r\n        appendText( $(this).find('option:selected').text(), $(\"#p_text\"));\r\n    });\r\n\r\n    $(\"#e\").click(function(){\r\n        appendText( $(this).find('option:selected').text(), $(\"#e_text\"));\r\n    });\r\n\r\n    $(\"#customize_class\").change(function(){\r\n        setCustomize($(\"#customize_class\").val(),$(\"#customize_type\").val());\r\n        $(\"#customize_text\").val(\"\");\r\n    });\r\n\r\n    $(\"#customize_type\").change(function(){\r\n        setCustomize($(\"#customize_class\").val(),$(\"#customize_type\").val());\r\n        $(\"#customize_text\").val(\"\");\r\n    });\r\n\r\n    $(\"#customize_select\").click(function(){\r\n        var select_id = \"#\" + $(\"#customize_type\").val().toLowerCase() + \"_text\";\r\n        appendText( $(this).find('option:selected').text(), $(select_id));\r\n    });\r\n\r\n    $(\"#customize_btn\").click(function(e){\r\n        e.preventDefault();\r\n        var inputdata = {};\r\n        inputdata['main_class'] = $(\"#customize_class\").val();\r\n        inputdata['types'] = $(\"#customize_type\").val();\r\n        inputdata['text'] = $(\"#customize_text\").val();\r\n        inputdata['_token'] = $('#customize > input[ name=_token]').val();\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/soap/get_customize',\r\n            data: inputdata,\r\n            success: function(result){\r\n                if(result == 'success'){\r\n                    setCustomize($(\"#customize_class\").val(),$(\"#customize_type\").val());\r\n                    $(\"#customize_text\").val(\"\");\r\n                    $(\"#customize_btn\").blur();\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    $(\"#soap_save_btn\").click(function(e){\r\n        e.preventDefault();\r\n        save_soap(false);\r\n    });\r\n\r\n    $(\"#soap_confirm_btn\").click(function(e){\r\n        e.preventDefault();\r\n        save_soap(true);\r\n    });\r\n\r\n    setCustomize($(\"#customize_class\").val(), $(\"#customize_type\").val());\r\n});\r\n\r\nfunction save_soap(confirm){\r\n\r\n    var inputdata = {};\r\n    inputdata['s_text'] = $(\"#s_text\").val();\r\n    inputdata['o_text'] = $(\"#o_text\").val();\r\n    inputdata['a_text'] = $(\"#a_text\").val();\r\n    inputdata['p_text'] = $(\"#p_text\").val();\r\n    inputdata['e_text'] = $(\"#e_text\").val();\r\n    inputdata['r_text'] = $(\"#r_text\").val();\r\n    inputdata['_token'] = $('#customize > input[ name=_token]').val();\r\n    var soap_nurse_class_pks = [];\r\n    $(\"input:checkbox[name=nurse]:checked\").each(function(){\r\n        soap_nurse_class_pks.push($(this).val());\r\n    });\r\n    inputdata['soa_nurse_class_pks'] = soap_nurse_class_pks.join();\r\n\r\n    if(confirm){\r\n        inputdata['confirm'] = true;\r\n    }\r\n\r\n    if($(\"#history_pk\").val() != \"\"){\r\n        inputdata['history'] = $(\"#history_pk\").val();\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: '/soap/post_soap',\r\n        data: inputdata,\r\n        success: function(result){\r\n            var words = result.split(\" \");\r\n            if(words[0] == 'success'){\r\n                alert(\"储存成功\");\r\n                var url = window.location.href;\r\n                if(url.indexOf(\"history=\") != -1){\r\n                    window.location.href = words[1];\r\n                }\r\n                $(\"#soap_save_btn\").blur();\r\n                $(\"#soap_confirm_btn\").blur();\r\n            }else{\r\n                alert(\"储存失败\");\r\n                $(\"#soap_save_btn\").blur();\r\n                $(\"#soap_confirm_btn\").blur();\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction delete_soap(soap_history_pk){\r\n\r\n    if (confirm(\"确定要删除吗?\") == true) {\r\n        var inputdata = {};\r\n        inputdata['_token'] = $('#soap_save > input[ name=_token]').val();\r\n        inputdata['history'] = soap_history_pk;\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/soap/delete_history',\r\n            data: inputdata,\r\n            success: function(result){\r\n                if(result == \"success\"){\r\n                    location.reload();\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction setSOAClass( sub_class_pk){\r\n    $.ajax({\r\n        type: 'GET',\r\n        url: '/soap/get_soa/' + sub_class_pk,\r\n        success: function(result){\r\n            if(result){\r\n                var html = \"\";\r\n                var soaps = [\"S\", \"O\", \"A\", \"E\"];\r\n                for(var j = 0; j < soaps.length; j++){\r\n                    var soap = soaps[j];\r\n                    for(var i = 0; i< result[soap].length; i++){\r\n                        html += '<option value=\"' + result[soap][i].soa_class_pk + '\">' + result[soap][i].class_name + '</option>';\r\n                    }\r\n                    $(\"#\"+soap.toLowerCase()).html(html);\r\n\r\n                    html = \"\";\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction setSOADetail(soa_class_pk){\r\n    $.ajax({\r\n        type: 'GET',\r\n        url: '/soap/get_soa_detail/' + soa_class_pk,\r\n        success: function(result){\r\n            if(result){\r\n                var html = \"\";\r\n                for(var i = 0; i< result.length; i++){\r\n                    html += '<option value=\"' + result[i].soa_detail_pk + '\">' + result[i].detail_name + '</option>';\r\n                }\r\n                $(\"#p\").html(html);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction setCustomize( main_class, type){\r\n    $.ajax({\r\n        type: 'GET',\r\n        url: '/soap/get_customize/' + main_class + '/' + type,\r\n        success: function(result){\r\n            if(result){\r\n                var html = \"\";\r\n                for(var i = 0; i< result.length; i++){\r\n                    html += '<option value=\"' + result[i].user_customize_pk + '\">' + result[i].text + '</option>';\r\n                }\r\n                $(\"#customize_select\").html(html);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction appendText( text, textarea){\r\n    var old = textarea.val();\r\n    textarea.val( old + get_number(old)+ \". \" + text + \"\\n\");\r\n    textarea.scrollTop(textarea[0].scrollHeight);\r\n}\r\n\r\nfunction get_number(text){\r\n    if(text){\r\n        lines = text.split(\"\\n\");\r\n        for(var i = lines.length-1; i >= 0; i--){\r\n            heads = lines[i].split(\".\");\r\n            if(!isNaN(heads[0]) && heads[0] != \"\"){\r\n                return parseInt(heads[0])+1;\r\n            }\r\n        }\r\n    }\r\n\r\n    return 1;\r\n}"],"sourceRoot":"/source/"}